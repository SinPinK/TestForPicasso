import _slicedToArray from"@babel/runtime/helpers/slicedToArray";import _objectWithoutProperties from"@babel/runtime/helpers/objectWithoutProperties";var _excluded=["size","level","activeItem","addLevel","className","deleteLevel","items","setHoveredParenLevel","getLabel","getRightSideBar","getLeftSideBar","getSubItems","getGroupId","getAccent","getDisabled","getOnClick","getItemOnClick","onItemClick","getItemHTMLAttributes","getItemAs","sortGroup","getGroupLabel","direction","possibleDirections","offset","onSetDirection","hoveredParenLevel","spareDirection","anchorRef"];function _createForOfIteratorHelper(a,b){var c="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=_unsupportedIterableToArray(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var d=0,e=function(){};return{s:e,n:function n(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function e(a){throw a},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f,g=!0,h=!1;return{s:function s(){c=c.call(a)},n:function n(){var a=c.next();return g=a.done,a},e:function e(a){h=!0,f=a},f:function f(){try{g||null==c["return"]||c["return"]()}finally{if(h)throw f}}}}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}import"./ContextMenuLevel.css";import React,{createRef,useEffect,useMemo,useState}from"react";import{cn}from"../../../utils/bem";import{getGroups}from"../../../utils/getGroups";import{Popover}from"../../Popover/Popover";import{ContextMenuDivider}from"../ContextMenuDivider/ContextMenuDivider";import{ContextMenuGroupHeader}from"../ContextMenuGroupHeader/ContextMenuGroupHeader";import{ContextMenuItem}from"../ContextMenuItem/ContextMenuItem";import{contextMenuDefaultSize}from"../helpers";export var cnContextMenuLevel=cn("ContextMenuLevelDeprecated");function renderHeader(a,b,c,d){return a?React.createElement(ContextMenuGroupHeader,{label:a,first:b,size:d}):b?null:React.createElement(ContextMenuDivider,{size:d})}var timers=[];export function clearTimers(){var a,b=_createForOfIteratorHelper(timers);try{for(b.s();!(a=b.n()).done;){var c=a.value;clearTimeout(c)}}catch(a){b.e(a)}finally{b.f()}timers=[]}var closeDelay=300;export var ContextMenuLevel=React.forwardRef(function(a,b){var c=a.size,d=void 0===c?contextMenuDefaultSize:c,e=a.level,f=a.activeItem,g=a.addLevel,h=a.className,i=a.deleteLevel,j=a.items,k=a.setHoveredParenLevel,l=a.getLabel,m=a.getRightSideBar,n=a.getLeftSideBar,o=a.getSubItems,p=a.getGroupId,q=a.getAccent,r=a.getDisabled,s=a.getOnClick,t=a.getItemOnClick,u=a.onItemClick,v=a.getItemHTMLAttributes,w=a.getItemAs,x=a.sortGroup,y=a.getGroupLabel,z=a.direction,A=a.possibleDirections,B=a.offset,C=a.onSetDirection,D=a.hoveredParenLevel,E=a.spareDirection,F=a.anchorRef,G=_objectWithoutProperties(a,_excluded),H=useState(!1),I=_slicedToArray(H,2),J=I[0],K=I[1],L=getGroups(j,p,void 0,void 0,x&&function(c,a){return x(c.key,a.key)}),M=function(a,b){return"".concat(a,"-").concat(b)},N=useMemo(function constructItemRefs(){var a,b={},c=_createForOfIteratorHelper(L);try{for(c.s();!(a=c.n()).done;)for(var d=a.value,e=0;e<j.length;e++)b[M(d.key,e)]=createRef()}catch(a){c.e(a)}finally{c.f()}return b},[j]);return useEffect(function(){return 0!==e&&!J&&D<e&&(clearTimeout(timers[e]),timers[e]=setTimeout(function(){return i(e)},closeDelay)),function(){clearTimeout(timers[e])}},[J,D]),React.createElement(Popover,Object.assign({},G,{anchorRef:F,className:cnContextMenuLevel({firstLevel:0===e,direction:z},[h]),possibleDirections:A,spareDirection:E,direction:z,offset:B,onSetDirection:C,onMouseEnter:function onMouseEnter(){return K(!0)},onMouseLeave:function onMouseLeave(){return K(!1)},ref:b}),L.map(function(a,b){var c="function"==typeof y?y(a.key):void 0;return React.createElement("div",{className:cnContextMenuLevel("Group"),key:a.key},renderHeader(c,0===b,L.length,d),a.items.map(function(b,c){var h=M(a.key,c),i=N[h],j="function"==typeof r&&r(b),p=l(b),x="function"==typeof n?n(b):void 0,y="function"==typeof m?m(b):void 0,z="function"==typeof o?o(b):void 0,A=z&&!j?function(){g(e+1,z,i,h),k(e+1)}:function(){k(e)},B="function"==typeof q?q(b):void 0,C="function"==typeof v?v(b):{},D="function"==typeof w?w(b):void 0;return React.createElement(ContextMenuItem,Object.assign({},C,{ref:i,label:p,leftSide:x,rightSide:y,size:d,key:h,onMouseEnter:A,onClick:function onClick(a){if(!j){if("function"==typeof t){var c;null===(c=t(b))||void 0===c?void 0:c(a)}if("function"==typeof s){var d;null===(d=s(b))||void 0===d?void 0:d(a)}"function"==typeof u&&(null===u||void 0===u?void 0:u({e:a,item:b}))}},active:f===h,withSubMenu:!!z,accent:B,disabled:j,as:D}))}))}))});
//# sourceMappingURL=ContextMenuLevel.js.map