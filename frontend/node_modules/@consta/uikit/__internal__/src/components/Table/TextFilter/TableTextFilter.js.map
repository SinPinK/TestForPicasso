{"version":3,"file":"TableTextFilter.js","names":["IconSearchStroked","React","useMemo","useState","cn","Button","CheckboxGroup","Text","TextField","TableFilterContainer","cnTextFilter","TableTextFilter","items","withSearch","onConfirm","onCancel","filterValue","title","emptySearchText","searchValue","setSearchValue","checkboxGroupValue","setCheckboxGroupValue","filteredItems","filter","name","match","RegExp","isAllSelected","length","isSelected","confirmHandler","value","setAll","resetHandler","item"],"sources":["../../../../../../src/components/Table/TextFilter/TableTextFilter.tsx"],"sourcesContent":["import './TableTextFilter.css';\n\nimport { IconSearchStroked } from '@consta/icons/IconSearchStroked';\nimport React, { useMemo, useState } from 'react';\n\nimport { cn } from '../../../utils/bem';\nimport { Button } from '../../Button/Button';\nimport { CheckboxGroup } from '../../CheckboxGroup';\nimport { Text } from '../../Text/Text';\nimport { TextField } from '../../TextField/TextField';\nimport { TableFilterContainer } from '../FilterContainer/TableFilterContainer';\nimport { FilterComponentProps } from '../filtering';\n\nconst cnTextFilter = cn('TableTextFilter');\n\ntype Item = {\n  name: string;\n  value: string;\n};\n\ntype TableTextFilterProps = FilterComponentProps & {\n  items?: Item[];\n  withSearch?: boolean;\n  title?: string;\n  emptySearchText?: string;\n};\n\nexport const TableTextFilter: React.FC<TableTextFilterProps> = ({\n  items = [],\n  withSearch = false,\n  onConfirm,\n  onCancel,\n  filterValue,\n  title,\n  emptySearchText = 'Ничего не найдено :(',\n}) => {\n  const [searchValue, setSearchValue] = useState<string | null>(null);\n  const [checkboxGroupValue, setCheckboxGroupValue] = useState<Item[] | null>(\n    (filterValue as Item[]) || items,\n  );\n\n  const confirmHandler = () => {\n    setSearchValue(null);\n    onConfirm(checkboxGroupValue === null ? [] : checkboxGroupValue);\n  };\n\n  const resetHandler = () => {\n    setCheckboxGroupValue(null);\n  };\n\n  const filteredItems = useMemo(() => {\n    if (!searchValue) {\n      return items;\n    }\n\n    return items.filter(({ name }) => {\n      return name.match(new RegExp(`${searchValue}`, 'i'));\n    });\n  }, [searchValue, items]);\n\n  const setAll = () => {\n    setCheckboxGroupValue(filteredItems);\n  };\n\n  const isAllSelected = useMemo(\n    () => filteredItems.length === checkboxGroupValue?.length,\n    [filteredItems, checkboxGroupValue],\n  );\n\n  const isSelected = useMemo(\n    () => checkboxGroupValue?.length,\n    [checkboxGroupValue],\n  );\n\n  return (\n    <TableFilterContainer\n      title={title}\n      onCancel={onCancel}\n      onConfirm={confirmHandler}\n    >\n      {withSearch && (\n        <TextField\n          value={searchValue}\n          onChange={({ value }) => setSearchValue(value)}\n          leftSide={IconSearchStroked}\n          size=\"s\"\n          placeholder=\"Найти в списке\"\n          width=\"full\"\n          className={cnTextFilter('Searchbar')}\n        />\n      )}\n      <div className={cnTextFilter('Controls')}>\n        <Button\n          size=\"m\"\n          type=\"button\"\n          form=\"brick\"\n          label=\"Выбрать все\"\n          view=\"clear\"\n          onClick={setAll}\n          disabled={!filteredItems.length || isAllSelected}\n        />\n        <Button\n          size=\"m\"\n          form=\"brick\"\n          type=\"button\"\n          label=\"Сбросить\"\n          view=\"clear\"\n          onClick={resetHandler}\n          disabled={!filteredItems.length || !isSelected}\n        />\n      </div>\n      <div className={cnTextFilter('Checkboxes')}>\n        {filteredItems.length ? (\n          <CheckboxGroup\n            items={filteredItems}\n            value={checkboxGroupValue}\n            getItemLabel={(item) => item.name}\n            onChange={({ value }) => {\n              setCheckboxGroupValue(value);\n            }}\n            name=\"checkboxGroup\"\n          />\n        ) : (\n          <Text lineHeight=\"2xs\">{emptySearchText}</Text>\n        )}\n      </div>\n    </TableFilterContainer>\n  );\n};\n"],"mappings":"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"}