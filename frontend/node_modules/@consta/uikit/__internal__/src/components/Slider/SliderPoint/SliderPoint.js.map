{"version":3,"file":"SliderPoint.js","names":["React","useEffect","useRef","useFlag","useForkRef","cnMixFocus","cn","generateThemeClassNames","ThemeContext","useTheme","Tooltip","cnSliderPoint","getTooltipPosition","popoverPosition","buttonRef","current","getBoundingClientRect","y","height","x","SliderPoint","props","hovered","onHover","value","position","disabled","withTooltip","focused","handlePress","onKeyPress","tooltipFormatter","buttonLabel","onFocus","tooltipZIndex","otherProps","tooltipVisible","on","off","theme","tooltipTheme","color","primary","invert","accent","tooltipThemeClassNames","handleFocus","e","handleMouseAction","enter","pointRef","handleBlur","themeClassNames","zIndex"],"sources":["../../../../../../src/components/Slider/SliderPoint/SliderPoint.tsx"],"sourcesContent":["import './SliderPoint.css';\n\nimport React, { useEffect, useRef } from 'react';\n\nimport { useFlag } from '../../../hooks/useFlag/useFlag';\nimport { useForkRef } from '../../../hooks/useForkRef/useForkRef';\nimport { cnMixFocus } from '../../../mixs/MixFocus/MixFocus';\nimport { cn } from '../../../utils/bem';\nimport {\n  generateThemeClassNames,\n  ThemeContext,\n  useTheme,\n} from '../../Theme/Theme';\nimport { Tooltip } from '../../Tooltip/Tooltip';\nimport { SliderPointProps, TrackPosition } from '../helper';\n\nconst cnSliderPoint = cn('SliderPoint');\n\nconst getTooltipPosition = (\n  popoverPosition: TrackPosition,\n  buttonRef: React.RefObject<HTMLButtonElement>,\n) => {\n  if (popoverPosition && buttonRef && buttonRef.current) {\n    const { y, height } = buttonRef.current.getBoundingClientRect();\n    return {\n      x: popoverPosition.x,\n      y: y - height + 30,\n    };\n  }\n  return { x: 0, y: 0 };\n};\n\nexport const SliderPoint = (props: SliderPointProps) => {\n  const {\n    hovered,\n    onHover,\n    value,\n    position,\n    disabled,\n    withTooltip,\n    focused,\n    popoverPosition,\n    buttonRef,\n    handlePress,\n    onKeyPress,\n    tooltipFormatter,\n    buttonLabel,\n    onFocus,\n    tooltipZIndex,\n    ...otherProps\n  } = props;\n\n  const [tooltipVisible, { on, off }] = useFlag(false);\n\n  const { theme } = useTheme();\n\n  const tooltipTheme = {\n    ...theme,\n    color: {\n      primary: theme.color.invert,\n      accent: theme.color.accent,\n      invert: theme.color.primary,\n    },\n  };\n\n  const tooltipThemeClassNames = generateThemeClassNames(tooltipTheme);\n\n  useEffect(() => {\n    focused ? on() : off();\n  }, [focused]);\n\n  const handleFocus = (\n    e: React.FocusEvent<HTMLButtonElement> | React.MouseEvent,\n  ) => {\n    if (!disabled) {\n      onFocus?.(e, buttonLabel);\n      on();\n    }\n  };\n\n  const handleMouseAction = (enter: boolean) => {\n    if (!disabled) {\n      onHover?.(enter);\n      enter && on();\n      if (enter) on();\n      if (!enter && !focused) off();\n    }\n  };\n\n  const handleBlur = (\n    e:\n      | React.FocusEvent<HTMLButtonElement>\n      | React.MouseEvent<HTMLButtonElement>,\n  ) => {\n    if (!disabled) {\n      onFocus?.(e, null);\n      off();\n    }\n  };\n\n  const pointRef = useRef<HTMLButtonElement>(null);\n\n  return (\n    <>\n      <button\n        type=\"button\"\n        aria-label={`${buttonLabel}-button`}\n        className={cnSliderPoint({ hovered, disabled }, [\n          !disabled ? cnMixFocus() : '',\n        ])}\n        onMouseOver={() => handleMouseAction(true)}\n        onMouseOut={() => handleMouseAction(false)}\n        onMouseDown={() => handlePress?.(buttonLabel)}\n        onTouchStart={() => handlePress?.(buttonLabel)}\n        onKeyDown={(e) => onKeyPress?.(e, buttonLabel)}\n        onFocus={handleFocus}\n        onBlur={handleBlur}\n        onClick={handleFocus}\n        ref={useForkRef([buttonRef, pointRef])}\n        tabIndex={0}\n        style={{\n          ['--slider-button-left' as string]: `${position}%`,\n        }}\n        {...otherProps}\n      />\n      {tooltipVisible && withTooltip && popoverPosition && (\n        <ThemeContext.Provider\n          // eslint-disable-next-line react/jsx-no-constructed-context-values\n          value={{\n            theme: tooltipTheme,\n            themeClassNames: tooltipThemeClassNames,\n          }}\n        >\n          <Tooltip\n            position={getTooltipPosition(\n              popoverPosition,\n              buttonRef || pointRef,\n            )}\n            className={cnSliderPoint('Tooltip')}\n            direction=\"downCenter\"\n            possibleDirections={['downCenter', 'leftDown', 'rightDown']}\n            style={{ zIndex: tooltipZIndex }}\n          >\n            {tooltipFormatter ? tooltipFormatter(value) : value}\n          </Tooltip>\n        </ThemeContext.Provider>\n      )}\n    </>\n  );\n};\n"],"mappings":"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"}