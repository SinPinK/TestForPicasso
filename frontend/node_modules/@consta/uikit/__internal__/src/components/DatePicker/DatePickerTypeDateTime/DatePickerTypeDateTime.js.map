{"version":3,"file":"DatePickerTypeDateTime.js","names":["addMonths","startOfMonth","React","forwardRef","useEffect","useRef","useClickOutside","useFlag","setRef","DatePickerDropdown","DatePickerFieldTypeDateTime","datePickerPropFormatTypeDateTime","getDropdownZIndex","getMultiplicityTime","datePickerPropDateTimeViewDefault","useCurrentVisibleDate","DatePickerTypeDateTime","props","ref","events","dateTimeView","locale","dropdownForm","onFocus","dropdownClassName","currentVisibleDateProp","currentVisibleDate","onChangeCurrentVisibleDate","multiplicityHoursProp","multiplicityHours","multiplicityMinutesProp","multiplicityMinutes","multiplicitySecondsProp","multiplicitySeconds","renderAdditionalControls","otherProps","format","fieldRef","calendarRef","calendarVisible","setCalendarVisible","maxDate","minDate","value","startOfUnit","setCurrentVisibleDate","current","newVisibleDate","getTime","isActive","ignoreClicksInsideRefs","handler","off","onFocusHandler","e","on","onChange","style"],"sources":["../../../../../../src/components/DatePicker/DatePickerTypeDateTime/DatePickerTypeDateTime.tsx"],"sourcesContent":["import addMonths from 'date-fns/addMonths';\nimport startOfMonth from 'date-fns/startOfMonth';\nimport React, { forwardRef, useEffect, useRef } from 'react';\n\nimport { useClickOutside } from '../../../hooks/useClickOutside/useClickOutside';\nimport { useFlag } from '../../../hooks/useFlag/useFlag';\nimport { setRef } from '../../../utils/setRef';\nimport { DatePickerDropdown } from '../DatePickerDropdown/DatePickerDropdown';\nimport { DatePickerFieldTypeDateTime } from '../DatePickerFieldTypeDateTime/DatePickerFieldTypeDateTime';\nimport {\n  datePickerPropFormatTypeDateTime,\n  getDropdownZIndex,\n  getMultiplicityTime,\n} from '../helpers';\nimport {\n  datePickerPropDateTimeViewDefault,\n  DatePickerTypeComponent,\n} from '../types';\nimport { useCurrentVisibleDate } from '../useCurrentVisibleDate';\n\nexport const DatePickerTypeDateTime: DatePickerTypeComponent<'date-time'> =\n  forwardRef((props, ref) => {\n    const {\n      events,\n      dateTimeView = datePickerPropDateTimeViewDefault,\n      locale,\n      dropdownForm,\n      onFocus,\n      dropdownClassName,\n      currentVisibleDate: currentVisibleDateProp,\n      onChangeCurrentVisibleDate,\n      multiplicityHours: multiplicityHoursProp,\n      multiplicityMinutes: multiplicityMinutesProp,\n      multiplicitySeconds: multiplicitySecondsProp,\n      renderAdditionalControls,\n      ...otherProps\n    } = props;\n\n    const [multiplicityHours, multiplicityMinutes, multiplicitySeconds] =\n      getMultiplicityTime(\n        otherProps.format || datePickerPropFormatTypeDateTime,\n        multiplicityHoursProp,\n        multiplicityMinutesProp,\n        multiplicitySecondsProp,\n      );\n\n    const fieldRef = useRef<HTMLDivElement>(null);\n    const calendarRef = useRef<HTMLDivElement>(null);\n\n    const [calendarVisible, setCalendarVisible] = useFlag(false);\n\n    const [currentVisibleDate, setCurrentVisibleDate] = useCurrentVisibleDate({\n      currentVisibleDate: currentVisibleDateProp,\n      maxDate: props.maxDate,\n      minDate: props.minDate,\n      value: props.value,\n      startOfUnit: startOfMonth,\n      onChangeCurrentVisibleDate,\n      calendarVisible,\n    });\n\n    const onFocusHandler = (e: React.FocusEvent<HTMLElement>) => {\n      onFocus && onFocus(e);\n      setCalendarVisible.on();\n    };\n\n    useEffect(() => {\n      if (ref) {\n        setRef(ref, fieldRef.current);\n      }\n    }, [ref, fieldRef]);\n\n    useEffect(() => {\n      if (props.value && dateTimeView === 'classic' && currentVisibleDate) {\n        const newVisibleDate = startOfMonth(props.value);\n        if (newVisibleDate.getTime() !== currentVisibleDate.getTime()) {\n          setCurrentVisibleDate(newVisibleDate);\n        }\n        return;\n      }\n      if (props.value && dateTimeView !== 'classic' && currentVisibleDate) {\n        const newVisibleDate = startOfMonth(props.value);\n        if (\n          newVisibleDate.getTime() !== currentVisibleDate.getTime() &&\n          newVisibleDate.getTime() !==\n            addMonths(currentVisibleDate, 1).getTime()\n        ) {\n          setCurrentVisibleDate(newVisibleDate);\n        }\n      }\n    }, [props.value]);\n\n    useClickOutside({\n      isActive: calendarVisible,\n      ignoreClicksInsideRefs: [fieldRef, calendarRef],\n      handler: setCalendarVisible.off,\n    });\n\n    return (\n      <>\n        <DatePickerFieldTypeDateTime\n          {...otherProps}\n          ref={fieldRef}\n          onFocus={onFocusHandler}\n          multiplicityHours={multiplicityHours}\n          multiplicitySeconds={multiplicitySeconds}\n          multiplicityMinutes={multiplicityMinutes}\n        />\n        <DatePickerDropdown\n          ref={calendarRef}\n          anchorRef={fieldRef}\n          isOpen={calendarVisible}\n          value={props.value || undefined}\n          type=\"date-time\"\n          view={dateTimeView}\n          events={events}\n          className={dropdownClassName}\n          locale={locale}\n          minDate={props.minDate}\n          maxDate={props.maxDate}\n          currentVisibleDate={currentVisibleDate}\n          form={dropdownForm}\n          onChange={props.onChange}\n          renderAdditionalControls={renderAdditionalControls}\n          onChangeCurrentVisibleDate={setCurrentVisibleDate}\n          multiplicityHours={multiplicityHours}\n          multiplicitySeconds={multiplicitySeconds}\n          multiplicityMinutes={multiplicityMinutes}\n          zIndex={getDropdownZIndex(props.style)}\n        />\n      </>\n    );\n  });\n"],"mappings":"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"}