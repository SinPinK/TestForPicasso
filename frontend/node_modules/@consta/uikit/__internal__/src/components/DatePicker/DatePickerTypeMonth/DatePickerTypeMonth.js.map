{"version":3,"file":"DatePickerTypeMonth.js","names":["addYears","startOfYear","React","forwardRef","useEffect","useRef","useClickOutside","useFlag","setRef","DatePickerDropdown","DatePickerFieldTypeMonth","getDropdownZIndex","datePickerPropDateTimeViewDefault","useCurrentVisibleDate","DatePickerTypeMonth","props","ref","events","dateTimeView","locale","dropdownForm","dropdownClassName","onFocus","currentVisibleDateProp","currentVisibleDate","onChangeCurrentVisibleDate","renderAdditionalControls","otherProps","fieldRef","calendarRef","calendarVisible","setCalendarVisible","maxDate","minDate","value","startOfUnit","setCurrentVisibleDate","current","newVisibleDate","getTime","isActive","ignoreClicksInsideRefs","handler","off","onFocusHandler","e","on","params","onChange","style"],"sources":["../../../../../../src/components/DatePicker/DatePickerTypeMonth/DatePickerTypeMonth.tsx"],"sourcesContent":["import addYears from 'date-fns/addYears';\nimport startOfYear from 'date-fns/startOfYear';\nimport React, { forwardRef, useEffect, useRef } from 'react';\n\nimport { useClickOutside } from '../../../hooks/useClickOutside/useClickOutside';\nimport { useFlag } from '../../../hooks/useFlag/useFlag';\nimport { setRef } from '../../../utils/setRef';\nimport { DatePickerDropdown } from '../DatePickerDropdown/DatePickerDropdown';\nimport { DatePickerFieldTypeMonth } from '../DatePickerFieldTypeMonth/DatePickerFieldTypeMonth';\nimport { getDropdownZIndex } from '../helpers';\nimport {\n  datePickerPropDateTimeViewDefault,\n  DatePickerTypeComponent,\n} from '../types';\nimport { useCurrentVisibleDate } from '../useCurrentVisibleDate';\n\nexport const DatePickerTypeMonth: DatePickerTypeComponent<'month'> = forwardRef(\n  (props, ref) => {\n    const {\n      events,\n      dateTimeView = datePickerPropDateTimeViewDefault,\n      locale,\n      dropdownForm,\n      dropdownClassName,\n      onFocus,\n      currentVisibleDate: currentVisibleDateProp,\n      onChangeCurrentVisibleDate,\n      renderAdditionalControls,\n      ...otherProps\n    } = props;\n\n    const fieldRef = useRef<HTMLDivElement>(null);\n    const calendarRef = useRef<HTMLDivElement>(null);\n\n    const [calendarVisible, setCalendarVisible] = useFlag(false);\n\n    const [currentVisibleDate, setCurrentVisibleDate] = useCurrentVisibleDate({\n      currentVisibleDate: currentVisibleDateProp,\n      maxDate: props.maxDate,\n      minDate: props.minDate,\n      value: props.value,\n      startOfUnit: startOfYear,\n      onChangeCurrentVisibleDate,\n      calendarVisible,\n    });\n\n    const onFocusHandler = (e: React.FocusEvent<HTMLElement>) => {\n      onFocus && onFocus(e);\n      setCalendarVisible.on();\n    };\n\n    useEffect(() => {\n      if (ref) {\n        setRef(ref, fieldRef.current);\n      }\n    }, [ref, fieldRef]);\n\n    useEffect(() => {\n      if (props.value && dateTimeView === 'classic' && currentVisibleDate) {\n        const newVisibleDate = startOfYear(props.value);\n        if (newVisibleDate.getTime() !== currentVisibleDate.getTime()) {\n          setCurrentVisibleDate(newVisibleDate);\n        }\n        return;\n      }\n      if (props.value && dateTimeView !== 'classic' && currentVisibleDate) {\n        const newVisibleDate = startOfYear(props.value);\n        if (\n          newVisibleDate.getTime() !== currentVisibleDate.getTime() &&\n          newVisibleDate.getTime() !== addYears(currentVisibleDate, 1).getTime()\n        ) {\n          setCurrentVisibleDate(newVisibleDate);\n        }\n      }\n    }, [props.value]);\n\n    useClickOutside({\n      isActive: calendarVisible,\n      ignoreClicksInsideRefs: [fieldRef, calendarRef],\n      handler: setCalendarVisible.off,\n    });\n\n    return (\n      <>\n        <DatePickerFieldTypeMonth\n          {...otherProps}\n          ref={fieldRef}\n          onFocus={onFocusHandler}\n        />\n        <DatePickerDropdown\n          ref={calendarRef}\n          anchorRef={fieldRef}\n          isOpen={calendarVisible}\n          value={props.value || undefined}\n          type=\"month\"\n          view={dateTimeView}\n          events={events}\n          locale={locale}\n          minDate={props.minDate}\n          className={dropdownClassName}\n          maxDate={props.maxDate}\n          currentVisibleDate={currentVisibleDate}\n          form={dropdownForm}\n          onChange={(params) => {\n            props.onChange?.(params);\n            setCalendarVisible.off();\n          }}\n          renderAdditionalControls={renderAdditionalControls}\n          onChangeCurrentVisibleDate={setCurrentVisibleDate}\n          zIndex={getDropdownZIndex(props.style)}\n        />\n      </>\n    );\n  },\n);\n"],"mappings":"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"}