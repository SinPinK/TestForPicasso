{"version":3,"file":"TabsMoreItems.js","names":["IconMeatball","FocusTrap","React","useEffect","useRef","useState","Transition","useFlag","useForkRef","animateTimeout","cnMixPopoverAnimate","cn","Button","Popover","cnTabsMoreItems","TabsMoreItems","forwardRef","ref","items","renderItem","getLabel","getChecked","height","isOpen","off","toggle","buttonRef","popoverRef","direction","setDirection","length","animate","fallbackFocus","current","clickOutsideDeactivates","e","isClickInsideButton","contains","target","allowOutsideClick","onDeactivate","map","item","active"],"sources":["../../../../../../src/components/TabsDeprecated/MoreItems/TabsMoreItems.tsx"],"sourcesContent":["import './TabsMoreItems.css';\n\nimport { IconMeatball } from '@consta/icons/IconMeatball';\nimport FocusTrap from 'focus-trap-react';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Transition } from 'react-transition-group';\n\nimport { useFlag } from '../../../hooks/useFlag/useFlag';\nimport { useForkRef } from '../../../hooks/useForkRef/useForkRef';\nimport {\n  animateTimeout,\n  cnMixPopoverAnimate,\n} from '../../../mixs/MixPopoverAnimate/MixPopoverAnimate';\nimport { cn } from '../../../utils/bem';\nimport { Button } from '../../Button/Button';\nimport { Direction, Popover } from '../../Popover/Popover';\nimport { TabsPropGetLabel } from '../TabsDeprecated';\n\nconst cnTabsMoreItems = cn('TabsMoreItems');\n\ntype TabsMoreItems = <ITEM>(\n  props: {\n    items: ITEM[];\n    renderItem: (item: ITEM, onClick: () => void) => React.ReactNode;\n    getLabel: TabsPropGetLabel<ITEM>;\n    getChecked: (item: ITEM) => boolean;\n    height: number;\n  } & React.RefAttributes<HTMLDivElement>,\n  ref: React.Ref<HTMLDivElement>,\n) => React.ReactElement | null;\n\nexport const TabsMoreItems: TabsMoreItems = React.forwardRef(\n  ({ items, renderItem, getLabel, getChecked, height }, ref) => {\n    const [isOpen, { off, toggle }] = useFlag(false);\n    const buttonRef = useRef<HTMLDivElement>(null);\n    const popoverRef = useRef<HTMLDivElement>(null);\n    const [direction, setDirection] = useState<Direction>('downStartLeft');\n\n    useEffect(() => {\n      items.length === 0 && off();\n    }, [items]);\n\n    return (\n      <>\n        <div\n          ref={useForkRef([ref, buttonRef])}\n          className={cnTabsMoreItems('Button')}\n          style={{ height }}\n        >\n          <Button\n            size=\"xs\"\n            type=\"button\"\n            view=\"ghost\"\n            onlyIcon\n            iconLeft={IconMeatball}\n            onClick={toggle}\n          />\n        </div>\n        <Transition\n          in={isOpen}\n          unmountOnExit\n          nodeRef={popoverRef}\n          timeout={animateTimeout}\n        >\n          {(animate) => (\n            <Popover\n              anchorRef={buttonRef}\n              offset={-1}\n              ref={popoverRef}\n              direction=\"downStartRight\"\n              spareDirection=\"downStartLeft\"\n              className={cnTabsMoreItems('Popover', [\n                cnMixPopoverAnimate({ animate, direction }),\n              ])}\n              onSetDirection={setDirection}\n              possibleDirections={[\n                'downStartRight',\n                'downStartLeft',\n                'upStartRight',\n                'upStartLeft',\n                'downCenter',\n                'upCenter',\n              ]}\n            >\n              <FocusTrap\n                focusTrapOptions={{\n                  fallbackFocus: buttonRef.current ?? undefined,\n                  clickOutsideDeactivates: (e) => {\n                    const isClickInsideButton = buttonRef.current?.contains(\n                      e.target as Node,\n                    );\n                    return !isClickInsideButton;\n                  },\n                  allowOutsideClick: true,\n                  onDeactivate: off,\n                }}\n              >\n                <div className={cnTabsMoreItems('Content')}>\n                  {items.map((item) => (\n                    <div\n                      key={getLabel(item)}\n                      className={cnTabsMoreItems('Item', {\n                        active: getChecked(item),\n                      })}\n                    >\n                      {renderItem(item, off)}\n                    </div>\n                  ))}\n                </div>\n              </FocusTrap>\n            </Popover>\n          )}\n        </Transition>\n      </>\n    );\n  },\n);\n"],"mappings":"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"}