import _slicedToArray from"@babel/runtime/helpers/slicedToArray";import _defineProperty from"@babel/runtime/helpers/defineProperty";import _objectWithoutProperties from"@babel/runtime/helpers/objectWithoutProperties";var _excluded=["tooltipProps"],_excluded2=["mode","content","closeOnClickOutside","appearTimeout","exitTimeout","style"];function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _createForOfIteratorHelper(a,b){var c="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=_unsupportedIterableToArray(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var d=0,e=function(){};return{s:e,n:function n(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function e(a){throw a},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f,g=!0,h=!1;return{s:function s(){c=c.call(a)},n:function n(){var a=c.next();return g=a.done,a},e:function e(a){h=!0,f=a},f:function f(){try{g||null==c["return"]||c["return"]()}finally{if(h)throw f}}}}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}import React,{useEffect,useRef,useState}from"react";import{Tooltip}from"../../components/Tooltip/Tooltip";import{useForkRef}from"../../hooks/useForkRef/useForkRef";export var withTooltipPropMode=["mouseover","click"];export var withTooltipPropModeDefault=withTooltipPropMode[0];export var appearTimeoutDefault=400;export var exitTimeoutDefault=200;var closeFunctions=[];function clearTooltips(a,b){if(b){a.current.timer&&clearTimeout(a.current.timer);var e=closeFunctions.findIndex(function(b){return b===a});closeFunctions.splice(e,1)}else{var c,d=_createForOfIteratorHelper(closeFunctions);try{for(d.s();!(c=d.n()).done;){var f=c.value;a!==f&&(f.current.timer&&clearTimeout(f.current.timer),f.current.closeFunction&&f.current.closeFunction())}}catch(a){d.e(a)}finally{d.f()}closeFunctions.splice(0),closeFunctions.push(a)}}export function withTooltip(a){return function(b){return React.forwardRef(function(c,d){var e=c.tooltipProps,f=void 0===e?{}:e,g=_objectWithoutProperties(c,_excluded),h=_objectSpread(_objectSpread({},a),f),i=h.mode,j=void 0===i?"mouseover":i,k=h.content,l=h.closeOnClickOutside,m=h.appearTimeout,n=void 0===m?appearTimeoutDefault:m,o=h.exitTimeout,p=void 0===o?exitTimeoutDefault:o,q=h.style,r=_objectWithoutProperties(h,_excluded2),s=useState(!1),t=_slicedToArray(s,2),u=t[0],v=t[1],w=useRef(null),x=useRef(null),y=useRef({}),z=function(){y.current.timer&&clearTimeout(y.current.timer)},A=function(){"mouseover"===j&&u&&(y.current.timer=setTimeout(function(){return v(!1)},p))},B=function(){"mouseover"!==j||u||(y.current.timer=setTimeout(function(){return v(!0)},n))};useEffect(function(){return function(){return clearTooltips(y,!0)}},[]),useEffect(function(){u&&(y.current.closeFunction=function(){return v(!1)},clearTooltips(y))},[u]);return React.createElement(React.Fragment,null,React.createElement(b,Object.assign({},g,{onClick:function onClick(a){"click"===j&&v(!u),c.onClick&&(null===c||void 0===c?void 0:c.onClick(a))},onMouseEnter:function onMouseEnter(a){"mouseover"===j&&(z(),B()),c.onMouseEnter&&c.onMouseEnter(a)},onMouseLeave:function onMouseLeave(a){z(),A(),c.onMouseLeave&&c.onMouseLeave(a)},ref:useForkRef([w,d]),style:q})),u&&React.createElement(Tooltip,Object.assign({},r,{ref:x,anchorRef:w,onClickOutside:function onClickOutside(){"click"===j&&(!(void 0!==l)||l)&&v(!1)},onMouseEnter:function tooltipOnMouseEnter(a){z(),r.onMouseEnter&&r.onMouseEnter(a)},onMouseLeave:function tooltipOnMouseLeave(a){z(),A(),r.onMouseLeave&&r.onMouseLeave(a)},style:"number"==typeof(null===q||void 0===q?void 0:q.zIndex)?{zIndex:q.zIndex+1}:void 0}),k))})}}
//# sourceMappingURL=withTooltip.js.map